{% extends "base.html" %}

{% block title %}{{ _('dashboard') }}{% endblock %}

{% block head %}
<link rel="stylesheet" href="https://tiles.gebeta.app/static/gebeta-maps-lib.css" />
<script type="module" src="https://tiles.gebeta.app/static/gebeta-maps.umd.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjGwZZlgsXwSwnqrQLg5IAQ9L' + "'" + 'aqrDWS0="
    crossorigin=""></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.1"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

{% endblock %}

{% block content %}
<div id="main-wrapper" class="flex h-screen bg-gray-100 font-sans">
    <!-- Sidebar -->
    <aside class="w-64 sidebar text-gray-300 flex flex-col flex-shrink-0">
        <div class="p-4 flex justify-between items-center border-b border-gray-700">
            <div class="sidebar-header-text flex-grow">
                <img src="/static/img/Selamawi-logo 1 png.png" alt="{{ _('ride_app_logo') }}" class="h-12 w-full object-contain">
            </div>
            <button id="sidebar-toggle-btn" class="p-2 rounded-md hover:bg-gray-700"><svg class="h-6 w-6 text-white transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
        </div>
        <nav class="flex-1 px-2 py-4 space-y-1 overflow-y-auto">
            <!-- Dashboard -->
            <a href="#" class="sidebar-link flex items-center p-3 rounded-lg active" data-pane="dashboard" title="{{ _('dashboard') }}">
                <span class="icon-outline"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 8.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 018.25 20.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" /></svg></span>
                <span class="icon-solid"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" /></svg></span>
                <span class="sidebar-link-text">{{ _('dashboard') }}</span>
            </a>

            <!-- Operations Group -->
            <details class="sidebar-summary group" open>
                <summary class="flex items-center p-3 rounded-lg cursor-pointer">
                    <span class="sidebar-link-text group-title font-semibold text-xs uppercase tracking-wider text-gray-400">{{ _('operations') }}</span>
                    <span class="group-arrow ml-auto sidebar-link-text text-gray-400">&#9660;</span>
                </summary>
                <div class="pl-2 space-y-1">
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="active-rides" title="{{ _('active_rides') }}">
                        <span class="icon-outline"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m17.25 4.5a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h1.125c.621 0 1.125-.504 1.125-1.125V14.25m-16.5 4.5v-1.875a3.375 3.375 0 003.375-3.375h1.5a1.125 1.125 0 011.125 1.125v-1.5a3.375 3.375 0 00-3.375-3.375H3.375m15.75 9.375v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 003.375-3.375h1.5a1.125 1.125 0 011.125 1.125v16.5c0 .621-.504 1.125-1.125-1.125h-9.75" /></svg></span>
                        <span class="icon-solid"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">{{ _('active_rides') }}</span>
                        <span class="sidebar-badge hidden" id="active-rides-badge">0</span>
                    </a>
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="pending-requests" title="{{ _('pending_requests') }}">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">{{ _('pending_requests') }}</span>
                        <span class="sidebar-badge" id="pending-requests-badge">0</span>
                    </a>
                </div>
            </details>

             <!-- Management Group -->
            <details class="sidebar-summary group" open>
                <summary class="flex items-center p-3 rounded-lg cursor-pointer">
                    <span class="sidebar-link-text group-title font-semibold text-xs uppercase tracking-wider text-gray-400">{{ _('management') }}</span>
                    <span class="group-arrow ml-auto sidebar-link-text text-gray-400">&#9660;</span>
                </summary>
                 <div class="pl-2 space-y-1">
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="drivers" title="{{ _('drivers') }}">
                        <span class="icon-outline"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0012 15.75a7.488 7.488 0 00-5.982 2.975m11.963 0a9 9 0 10-11.963 0m11.963 0A8.966 8.966 0 0112 21a8.966 8.966 0 01-5.982-2.275M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" /></svg></span>
                        <span class="icon-solid"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-5.5-2.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM10 12a5.99 5.99 0 00-4.793 2.39A6.483 6.483 0 0010 16.5a6.483 6.483 0 004.793-2.11A5.99 5.99 0 0010 12z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">{{ _('drivers') }}</span>
                        <span class="sidebar-badge" id="drivers-badge">0</span>
                    </a>
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="passengers" title="{{ _('passengers') }}">
                        <span class="icon-outline"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m-7.284.144A9.09 9.09 0 019 18.72M5.25 8.25A3.75 3.75 0 019 4.5h6a3.75 3.75 0 013.75 3.75v3.75a3.75 3.75 0 01-3.75 3.75H9a3.75 3.75 0 01-3.75-3.75V8.25zM9 16.5h6" /></svg></span>
                        <span class="icon-solid"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z" /></svg></span>
                        <span class="sidebar-link-text">{{ _('passengers') }}</span>
                    </a>
                     <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="inbox" title="{{ _('inbox') }}">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z" /><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z" /></svg></span>
                        <span class="sidebar-link-text">{{ _('inbox') }}</span>
                        <span class="sidebar-badge" id="inbox-badge">0</span>
                    </a>
                </div>
            </details>

            <!-- Analytics & Reports Group -->
            <details class="sidebar-summary group">
                <summary class="flex items-center p-3 rounded-lg cursor-pointer">
                    <span class="sidebar-link-text group-title font-semibold text-xs uppercase tracking-wider text-gray-400">{{ _('analytics') }}</span>
                    <span class="group-arrow ml-auto sidebar-link-text text-gray-400">&#9660;</span>
                </summary>
                 <div class="pl-2 space-y-1">
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="analytics" title="{{ _('analytics') }}">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 013 19.875v-6.75zM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V8.625zM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 01-1.125-1.125V4.125z" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M2 10a8 8 0 1116 0 8 8 0 01-16 0zm10 2a2 2 0 100-4 2 2 0 000 4z" /><path fill-rule="evenodd" d="M12 2.25a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0112 2.25zM5.25 12a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5h-1.5a.75.75 0 01-.75-.75zM12 15.75a.75.75 0 01-.75.75v1.5a.75.75 0 011.5 0v-1.5a.75.75 0 01-.75-.75zM15.75 12a.75.75 0 01.75-.75h1.5a.75.75 0 010 1.5h-1.5a.75.75 0 01-.75-.75z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">{{ _('analytics') }}</span>
                    </a>
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="report-export" title="Export Reports">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 2.75a.75.75 0 00-1.5 0v8.614L6.295 8.235a.75.75 0 10-1.09 1.03l4.25 4.5a.75.75 0 001.09 0l4.25-4.5a.75.75 0 00-1.09-1.03l-2.955 3.129V2.75z" /><path d="M3.5 12.75a.75.75 0 00-1.5 0v2.5A2.75 2.75 0 004.75 18h10.5A2.75 2.75 0 0018 15.25v-2.5a.75.75 0 00-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5z" /></svg></span>
                        <span class="sidebar-link-text">Export Reports</span>
                    </a>
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="rides" title="{{ _('ride_history') }}">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.555 3.333a2.5 2.5 0 012.222-1.111c1.246 0 2.384.693 2.889 1.75 1.003 2.103 2.222 3.333 2.222 3.333V1.667a.833.833 0 111.667 0v11.666a.833.833 0 11-1.667 0v-1.25a3.333 3.333 0 00-3.333-3.333h-1.667a.833.833 0 010-1.667h1.667a1.667 1.667 0 011.667 1.667v1.25a.833.833 0 11-1.667 0V9.167a1.667 1.667 0 01-1.15-.693.834.834 0 01-.22-.644c0-.333.17-.633.427-.811A13.333 13.333 0 018.333 5a3.333 3.333 0 00-2.778-1.667z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">{{ _('ride_history') }}</span>
                    </a>
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="driver-earnings" title="Driver Earnings">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10.75 10.818v2.614A3.13 3.13 0 0011.888 13c.482-.315.612-.648.612-.875 0-.227-.13-.56-.612-.875a3.13 3.13 0 00-1.138-.432zM8.33 8.62c.053.055.115.11.184.164.208.16.46.284.736.363V6.603a2.45 2.45 0 00-.35.13c-.14.065-.27.143-.386.233A3.13 3.13 0 008.33 8.62z" /><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-6a.75.75 0 01.75.75v.316a3.13 3.13 0 001.138.432c.482.315.612.648.612.875 0 .227-.13.56-.612.875a3.13 3.13 0 00-1.138.432V9.25A.75.75 0 1110 9.25v-.316a3.13 3.13 0 00-1.138-.432c-.482-.315-.612-.648-.612-.875 0-.227.13-.56.612-.875A3.13 3.13 0 0010 6.316V4.75A.75.75 0 0110 4.75z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">Driver Earnings</span>
                    </a>
                </div>
            </details>

            <!-- Support Group -->
            <details class="sidebar-summary group">
                <summary class="flex items-center p-3 rounded-lg cursor-pointer">
                    <span class="sidebar-link-text group-title font-semibold text-xs uppercase tracking-wider text-gray-400">Support</span>
                    <span class="group-arrow ml-auto sidebar-link-text text-gray-400">&#9660;</span>
                </summary>
                 <div class="pl-2 space-y-1">
                    <a href="#" class="sidebar-link flex items-center p-3 rounded-lg" data-pane="support-tickets" title="Support Tickets">
                        <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 010 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 010-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375z" /></svg></span>
                        <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M2 3.5A1.5 1.5 0 013.5 2h13A1.5 1.5 0 0118 3.5v2.879a2.25 2.25 0 010 3.242V13.5A1.5 1.5 0 0116.5 15h-13A1.5 1.5 0 012 13.5V9.621a2.25 2.25 0 010-3.242V3.5zm2.75 6.375h10.5a.75.75 0 010 1.5H4.75a.75.75 0 010-1.5z" clip-rule="evenodd" /></svg></span>
                        <span class="sidebar-link-text">Support Tickets</span>
                        <span class="sidebar-badge" id="tickets-badge">0</span>
                    </a>
                </div>
            </details>

            <!-- Settings -->
            <a href="#" class="sidebar-link flex items-center p-3 rounded-lg mt-auto" data-pane="settings" title="{{ _('settings') }}">
                <span class="icon-outline"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg></span>
                <span class="icon-solid"><svg class="h-5 w-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 11.414V16a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-4.586l.293.293a1 1 0 001.414-1.414l-7-7z" clip-rule="evenodd" /></svg></span>
                <span class="sidebar-link-text">{{ _('settings') }}</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-6 lg:p-8 overflow-y-auto main-content flex flex-col">
        <!-- Main Header -->
        <header class="flex justify-between items-center mb-6 flex-shrink-0">
            <h2 id="pane-title" class="text-3xl font-bold title-gradient">{{ _('dashboard') }}</h2>
            <div class="flex items-center gap-4">
                 <div class="relative lang-dropdown">
                    <button id="lang-dropdown-btn" class="p-2 rounded-full text-gray-500 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700" title="{{ _('change_language') }}">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 006 3.75v16.5a2.25 2.25 0 002.25 2.25h7.5A2.25 2.25 0 0018 20.25V3.75a2.25 2.25 0 00-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
                        </svg>
                        <span class="ml-1 text-xs font-medium">{{ session.get('language', 'en').upper() }}</span>
                    </button>
                    <div id="lang-dropdown-content" class="lang-dropdown-content absolute right-0 mt-2 w-40 rounded-md shadow-lg bg-white dark:bg-gray-800 ring-1 ring-black ring-opacity-5 hidden z-50">
                        <a href="{{ url_for('change_language', lang='en') }}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span class="mr-2">üá∫üá∏</span>
                            {{ _('english') }}
                        </a>
                        <a href="{{ url_for('change_language', lang='am') }}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span class="mr-2">üá™üáπ</span>
                            {{ _('amharic') }}
                        </a>
                        <a href="{{ url_for('change_language', lang='ti') }}" class="flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                            <span class="mr-2">üá™üá∑</span>
                            {{ _('tigrinya') }}
                        </a>
                    </div>
                </div>

                <label for="dark-mode-toggle-checkbox" class="cursor-pointer">
                    <input type="checkbox" id="dark-mode-toggle-checkbox" class="hidden">
                    <span id="dark-mode-icon" class="text-xl">‚òÄÔ∏è</span>
                </label>
                <div id="notification-bell" class="relative cursor-pointer">
                    <svg class="h-6 w-6 text-gray-500 dark:text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                    </svg>
                    <div id="notification-badge" class="notification-badge hidden">0</div>
                <div id="notification-dropdown" class="hidden"></div>
                </div>
                
                <div class="flex items-center ml-2 border-l border-gray-200 dark:border-gray-700 pl-4">
                    <img id="sidebar-avatar" src="/{{ current_user.profile_picture or 'static/img/default_avatar.png' }}" class="h-10 w-10 rounded-full object-cover flex-shrink-0" alt="{{ _('dispatcher') }}">
                    <div class="ml-3">
                        <p class="text-sm font-semibold text-primary">{{ current_user.username | capitalize }} <span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full">üöó Dispatcher</span></p>
                        <div class="flex items-center gap-2">
                            <a href="{{ url_for('auth.switch_role', role='passenger') }}" class="text-xs text-blue-500 hover:underline" title="Switch to Passenger Mode">üë§ Passenger</a>
                            <span class="text-xs text-gray-400">|</span>
                        <a href="{{ url_for('auth.logout') }}" class="text-xs text-red-500 hover:underline">{{ _('logout') }}</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="flex-grow overflow-y-auto">
            <div id="dashboard-pane" class="pane active">
                <div class="dashboard-grid dashboard-grid-6">
                    <div class="stat-card-modern animate-fade-in">
                        <div class="stat-card-content">
                        <div class="stat-icon-modern gradient-bg-success">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                    </div>
                            <div class="stat-card-info">
                                <p class="stat-card-label">Total Revenue</p>
                                <p id="stat-revenue" class="stat-card-value">0 ETB</p>
                            </div>
                    </div>
                    </div>
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.1s">
                        <div class="stat-icon-modern gradient-bg-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m3 0h6m-9 0H3.375a1.125 1.125 0 01-1.125-1.125V14.25m6 4.5v-3a3 3 0 00-3-3H6.75a3 3 0 00-3 3v3m6 0V9.75a3 3 0 00-3-3H6.75a3 3 0 00-3 3v9.75m6 0h6m-6 0v-3a3 3 0 013-3h2.25a3 3 0 013 3v3m-6 0H9.375a1.125 1.125 0 01-1.125-1.125V14.25" />
                            </svg>
                    </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Total Rides</p>
                            <p id="stat-rides" class="text-lg font-bold text-primary">0</p>
                </div>
                    </div>
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.2s">
                        <div class="stat-icon-modern gradient-bg-secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Total Users</p>
                            <p id="stat-users" class="text-lg font-bold text-primary">0</p>
                        </div>
                    </div>
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.3s">
                        <div class="stat-icon-modern gradient-bg-warning">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Total Drivers</p>
                            <p id="stat-drivers" class="text-lg font-bold text-primary">0</p>
                        </div>
                    </div>
                </div>
                <div class="dashboard-grid dashboard-grid-4">
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.4s">
                        <div class="stat-icon-modern gradient-bg-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Completed Rides</p>
                            <p id="stat-completed" class="text-lg font-bold text-primary">0</p>
                        </div>
                    </div>
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.5s">
                        <div class="stat-icon-modern gradient-bg-danger">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Active Rides</p>
                            <p id="stat-active" class="text-lg font-bold text-primary">0</p>
                        </div>
                    </div>
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.6s">
                        <div class="stat-icon-modern gradient-bg-success">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Today's Revenue</p>
                            <p id="stat-today-revenue" class="text-lg font-bold text-primary">0 ETB</p>
                        </div>
                    </div>
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.7s">
                        <div class="stat-icon-modern gradient-bg-danger">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Pending Requests</p>
                            <p id="stat-pending" class="text-lg font-bold text-primary">0</p>
                        </div>
                    </div>
                </div>
                <div class="dashboard-grid dashboard-grid-4">
                    <div class="stat-card-modern animate-fade-in" style="animation-delay: 0.8s">
                        <div class="stat-icon-modern gradient-bg-warning">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 01-.825-.242m9.345-8.334a2.126 2.126 0 00-.476-.095 48.64 48.64 0 00-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0011.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs text-secondary mb-1">Open Support Tickets</p>
                            <p id="stat-open-tickets" class="text-lg font-bold text-primary">0</p>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions Section -->
                <div class="modern-card p-4 mb-6">
                    <h3 class="font-semibold text-primary mb-4 text-lg">Quick Actions</h3>
                    <div class="dashboard-grid dashboard-grid-6">
                        <button onclick="showPane('drivers')" class="quick-action-btn">
                            <div class="quick-action-icon bg-blue-100 text-blue-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
                                </svg>
                            </div>
                            <span class="text-xs font-medium">Manage Drivers</span>
                        </button>
                        <button onclick="showPane('passengers')" class="quick-action-btn">
                            <div class="quick-action-icon bg-green-100 text-green-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                            <span class="text-xs font-medium">Manage Passengers</span>
                        </button>
                        <button onclick="showPane('rides')" class="quick-action-btn">
                            <div class="quick-action-icon bg-purple-100 text-purple-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                </svg>
                            </div>
                            <span class="text-xs font-medium">Ride History</span>
                        </button>
                        <button onclick="showPane('analytics')" class="quick-action-btn">
                            <div class="quick-action-icon bg-yellow-100 text-yellow-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                            </div>
                            <span class="text-xs font-medium">Analytics</span>
                        </button>
                        <button onclick="showPane('inbox')" class="quick-action-btn">
                            <div class="quick-action-icon bg-red-100 text-red-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                                </svg>
                            </div>
                            <span class="text-xs font-medium">Feedback</span>
                        </button>
                        <button onclick="showPane('settings')" class="quick-action-btn">
                            <div class="quick-action-icon bg-gray-100 text-gray-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </div>
                            <span class="text-xs font-medium">Settings</span>
                        </button>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-8 mb-8">
                    <div class="lg:col-span-3 card p-6 rounded-lg shadow"><h3 class="font-semibold mb-4 text-primary">{{ _('live_rides_map') }}</h3><div id="dashboard-map" class="h-96 w-full rounded"></div></div>
                    <div class="lg:col-span-2 card p-6 rounded-lg shadow">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-semibold text-primary">{{ _('pending_rides') }}</h3>
                            <a href="#" class="text-sm text-indigo-600 font-semibold hover:underline" onclick="showPane('pending-requests'); return false;">{{ _('view_all') }}</a>
                        </div>
                        <div id="pending-rides-summary-list" class="space-y-3 overflow-y-auto h-96"></div>
                    </div>
                </div>
            </div>

            <div id="pending-requests-pane" class="pane">
                <div class="space-y-6">
                    <!-- Header -->
                    <div class="modern-card p-6">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-2">Pending Ride Requests</h3>
                                <p class="text-secondary">Smart driver assignment with real-time suggestions</p>
                    </div>
                            <div class="flex gap-3">
                                <button id="refresh-pending-btn" class="btn-modern btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                    Refresh
                                </button>
                            </div>
                        </div>
                        
                        <!-- Quick Stats -->
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4">
                            <div class="stat-card-modern">
                                <div class="stat-icon-modern gradient-bg-danger">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Pending Requests</p>
                                    <p id="pending-count" class="text-lg font-bold text-primary">0</p>
                                </div>
                            </div>
                            <div class="stat-card-modern">
                                <div class="stat-icon-modern gradient-bg-success">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Available Drivers</p>
                                    <p id="available-drivers-count" class="text-lg font-bold text-primary">0</p>
                                </div>
                            </div>
                            <div class="stat-card-modern">
                                <div class="stat-icon-modern gradient-bg-warning">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Avg Wait Time</p>
                                    <p id="avg-wait-time" class="text-lg font-bold text-primary">0 min</p>
                                </div>
                            </div>
                            <div class="stat-card-modern">
                                <div class="stat-icon-modern gradient-bg-primary">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Success Rate</p>
                                    <p id="assignment-success-rate" class="text-lg font-bold text-primary">0%</p>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Pending Rides Container -->
                    <div id="pending-rides-container" class="space-y-4">
                        <!-- Rides will be dynamically loaded here -->
                    </div>
                </div>
            </div>
            
            <div id="analytics-pane" class="pane">
                <div class="space-y-6">
                    <!-- Analytics Header -->
                    <div class="modern-card p-6">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-2">Analytics & Reports</h3>
                                <p class="text-secondary">Comprehensive business intelligence and performance metrics</p>
                            </div>
                            <div class="flex gap-3">
                                <button id="export-analytics-btn" class="btn-modern btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Export Report
                                </button>
                            </div>
                        </div>
                        
                        <!-- Analytics Filters -->
                    <div id="analytics-filters" class="flex flex-wrap items-center gap-x-6 gap-y-2">
                            <h4 class="text-lg font-semibold text-primary">Filter by Date</h4>
                        <div class="flex items-center gap-2" id="analytics-period-btns">
                                <button data-period="today" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">Today</button>
                                <button data-period="week" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">This Week</button>
                                <button data-period="month" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">This Month</button>
                                <button data-period="all" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">All Time</button>
                        </div>
                            <div class="flex items-center gap-2">
                                <input type="date" id="start-date-input" class="border p-1.5 rounded-md text-sm">
                                <span class="text-gray-500">to</span>
                                <input type="date" id="end-date-input" class="border p-1.5 rounded-md text-sm">
                                <button id="custom-range-btn" class="px-3 py-1.5 text-sm font-semibold rounded-md bg-indigo-600 text-white">Apply</button>
                    </div>
                </div>
                </div>

                    <!-- Key Performance Indicators -->
                    <div class="modern-card p-6">
                        <h4 class="text-lg font-semibold text-primary mb-4">Key Performance Indicators</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div class="kpi-card">
                                <div class="kpi-icon bg-blue-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                    </svg>
                    </div>
                                <div>
                                    <p class="kpi-label">Rides Completed</p>
                                    <p id="kpi-rides-completed" class="kpi-value">0</p>
                                    <p id="kpi-rides-trend" class="kpi-trend">+0%</p>
                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-icon bg-green-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="kpi-label">Active Rides Now</p>
                                    <p id="kpi-active-rides-now" class="kpi-value">0</p>
                                    <p id="kpi-active-trend" class="kpi-trend">+0%</p>
                                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-icon bg-red-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="kpi-label">Rides Canceled</p>
                                    <p id="kpi-rides-canceled" class="kpi-value">0</p>
                                    <p id="kpi-cancel-trend" class="kpi-trend">+0%</p>
                                </div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-icon bg-yellow-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="kpi-label">Total Revenue</p>
                                    <p id="kpi-total-revenue" class="kpi-value">0 ETB</p>
                                    <p id="kpi-revenue-trend" class="kpi-trend">+0%</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Revenue Chart -->
                        <div class="modern-card p-6">
                            <h4 class="text-lg font-semibold text-primary mb-4">Revenue Over Time</h4>
                            <div class="chart-container">
                                <canvas id="revenueChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <!-- Vehicle Distribution Chart -->
                        <div class="modern-card p-6">
                            <h4 class="text-lg font-semibold text-primary mb-4">Vehicle Type Distribution</h4>
                            <div class="chart-container">
                                <canvas id="vehicleDistChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Performance Metrics -->
                    <div class="modern-card p-6">
                        <h4 class="text-lg font-semibold text-primary mb-4">Performance Metrics</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="performance-metric">
                                <div class="text-3xl font-bold text-blue-600 mb-2" id="avg-fare">0 ETB</div>
                                <div class="text-sm text-secondary">Average Fare</div>
                            </div>
                            <div class="performance-metric">
                                <div class="text-3xl font-bold text-green-600 mb-2" id="completion-rate">0%</div>
                                <div class="text-sm text-secondary">Completion Rate</div>
                            </div>
                            <div class="performance-metric">
                                <div class="text-3xl font-bold text-purple-600 mb-2" id="avg-rating">0.0</div>
                                <div class="text-sm text-secondary">Average Rating</div>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Charts Section -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Payment Method Distribution Chart -->
                        <div class="modern-card p-6">
                            <h4 class="text-lg font-semibold text-primary mb-4">Payment Method Distribution</h4>
                            <div class="chart-container">
                                <canvas id="paymentDistChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <!-- Ride Status Distribution Chart -->
                        <div class="modern-card p-6">
                            <h4 class="text-lg font-semibold text-primary mb-4">Ride Status Distribution</h4>
                            <div class="chart-container">
                                <canvas id="rideStatusChart" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Top Drivers Section -->
                    <div class="modern-card p-6">
                        <h4 class="text-lg font-semibold text-primary mb-4">Top Performing Drivers</h4>
                        <div id="top-drivers-list" class="space-y-3">
                            <!-- Top drivers will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="inbox-pane" class="pane">
                <div class="card p-6 rounded-lg shadow">
                    <h3 class="text-xl font-semibold mb-4 text-primary">Feedback & Ratings</h3>
                    <p class="text-sm text-secondary mb-4">View all ratings, comments, and reports from passengers here.</p>
                    <div id="feedback-list" class="space-y-4"></div>
                </div>
            </div>

            <div id="support-tickets-pane" class="pane">
                <div class="space-y-6">
                    <!-- Support Tickets Header -->
                    <div class="modern-card p-6">
                    <div class="flex justify-between items-center mb-4">
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-2">Support Tickets</h3>
                                <p class="text-secondary">Manage passenger inquiries and issues</p>
                            </div>
                            <div class="flex gap-3">
                                <button class="btn-modern btn-secondary" onclick="refreshSupportTickets()">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                            Refresh
                        </button>
                                <button class="btn-modern btn-primary" onclick="createSampleTickets()">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                    Add Sample
                                </button>
                    </div>
                    </div>
                        
                        <!-- Support Stats -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div class="stat-card">
                                <div class="stat-card-icon bg-blue-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Total Tickets</p>
                                    <p id="total-tickets" class="text-2xl font-bold text-primary">0</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card-icon bg-red-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Open Tickets</p>
                                    <p id="open-tickets" class="text-2xl font-bold text-primary">0</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card-icon bg-yellow-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">In Progress</p>
                                    <p id="in-progress-tickets" class="text-2xl font-bold text-primary">0</p>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card-icon bg-green-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-secondary mb-1">Resolved</p>
                                    <p id="resolved-tickets" class="text-2xl font-bold text-primary">0</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Support Tickets List -->
                    <div class="modern-card p-6">
                        <h4 class="text-lg font-semibold text-primary mb-4">All Support Tickets</h4>
                        <div id="support-tickets-list" class="space-y-4">
                            <div class="text-center py-8">
                                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"></div>
                                <p class="text-secondary">Loading support tickets...</p>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>

            <div id="report-export-pane" class="pane">
                <div class="card p-6 rounded-lg shadow max-w-2xl mx-auto">
                    <h3 class="text-xl font-semibold mb-2 text-primary">Generate Analytics Report</h3><p class="text-secondary mb-4">Export a detailed report of rides, revenue, and performance metrics for a specific date range.</p>
                    <div class="p-4 rounded-lg bg-[--main-bg] border border-[--border-color]">
                        <div class="flex flex-wrap items-center gap-x-6 gap-y-2">
                            <h3 class="text-md font-semibold text-primary">1. Select Date Range</h3>
                            <div class="flex items-center gap-2" id="report-period-btns">
                                <button data-period="today" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">{{ _('today') }}</button>
                                <button data-period="week" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">{{ _('this_week') }}</button>
                                <button data-period="month" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">{{ _('this_month') }}</button>
                                <button data-period="all" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700 active-filter">{{ _('all_time') }}</button>
                            </div>
                            <div class="flex items-center gap-2"><input type="date" id="report-start-date" class="border p-1.5 rounded-md text-sm"><span class="text-gray-500">{{ _('to') }}</span><input type="date" id="report-end-date" class="border p-1.5 rounded-md text-sm"><button id="report-custom-range-btn" class="px-3 py-1.5 text-sm font-semibold rounded-md bg-indigo-600 text-white">{{ _('apply') }}</button></div>
                        </div>
                        <div class="mt-6">
                            <h3 class="text-md font-semibold text-primary mb-2">2. Choose Format & Download</h3>
                            <div class="flex justify-start space-x-4">
                                <button id="export-pdf-btn" class="flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-md bg-red-600 text-white hover:bg-red-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm.5 8.106a.5.5 0 01.5-.5h2a.5.5 0 01.5.5v3.563a.5.5 0 01-.5.5h-2a.5.5 0 01-.5-.5V12.106zM7 7.5a.5.5 0 00-.5.5v2.063a.5.5 0 101 0V8a.5.5 0 00-.5-.5H7zm4 0a.5.5 0 00-.5.5v6.063a.5.5 0 101 0V8a.5.5 0 00-.5-.5h-1zm-1.5.5a.5.5 0 01.5-.5h2a.5.5 0 01.5.5v2.063a.5.5 0 11-1 0V8.53a.5.5 0 010-.03V8a.5.5 0 01.5-.5z" clip-rule="evenodd" /></svg>Download PDF</button>
                                <button id="export-excel-btn" class="flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-md bg-green-600 text-white hover:bg-green-700"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M2 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm3.5 1a.5.5 0 00-.5.5v1.293l3.5 3.5 3.5-3.5V6.5a.5.5 0 00-1 0v.293L10 9.293 6.5 5.793V6.5a.5.5 0 00-.5-.5h-1z" /></svg>Download Excel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="active-rides-pane" class="pane">
                <div class="card p-6 rounded-lg shadow"><table class="w-full text-left"><thead><tr class="border-b border-border"><th class="p-2">Passenger</th><th>Driver</th><th>Destination</th><th>Status</th><th>Actions</th></tr></thead><tbody id="active-rides-table-body"></tbody></table></div>
            </div>

            <div id="drivers-pane" class="pane">
                <div class="space-y-6">
                    <!-- Header with Quick Actions -->
                    <div class="modern-card p-6">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-2">Driver Management</h3>
                                <p class="text-secondary">Manage drivers, view performance, and handle assignments</p>
                    </div>
                            <div class="flex gap-3">
                                <button id="add-driver-btn" class="btn-modern btn-success">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                    </svg>
                                    Add Driver
                                </button>
                                <button id="export-drivers-btn" class="btn-modern btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Export
                                </button>
                            </div>
                        </div>
                        
                        <!-- Filters and Search -->
                        <div class="flex flex-wrap gap-4 mb-6">
                            <div class="flex-1 min-w-64">
                                <input type="text" id="driver-search-input" placeholder="Search by name, phone, or ID..." class="border border-border rounded-md px-3 py-2 w-full">
                            </div>
                            <div class="min-w-48">
                                <select id="driver-status-filter" class="border border-border rounded-md px-3 py-2 w-full">
                                    <option value="All">All Statuses</option>
                                    <option value="Available">Available</option>
                                    <option value="On Trip">On Trip</option>
                                    <option value="Offline">Offline</option>
                                </select>
                            </div>
                            <div class="min-w-48">
                                <select id="driver-vehicle-filter" class="border border-border rounded-md px-3 py-2 w-full">
                                    <option value="All">All Vehicles</option>
                                    <option value="Bajaj">Bajaj</option>
                                    <option value="Car">Car</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button id="clear-driver-filters-btn" class="btn-modern btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                    </svg>
                                    Clear
                                </button>
                            </div>
                        </div>

                        <!-- Batch Actions -->
                        <div class="flex items-center gap-4 mb-6">
                            <div class="flex items-center">
                                <input type="checkbox" id="select-all-drivers" class="rounded border-border">
                                <label for="select-all-drivers" class="ml-2 text-sm text-primary">Select All</label>
                            </div>
                            <div class="flex gap-2" id="batch-driver-actions" style="display: none;">
                                <button id="batch-online-drivers" class="btn-modern btn-success text-sm px-3 py-1">
                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    Mark Online
                                </button>
                                <button id="batch-offline-drivers" class="btn-modern btn-secondary text-sm px-3 py-1">
                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    Mark Offline
                                </button>
                                <button id="batch-block-drivers" class="btn-modern btn-danger text-sm px-3 py-1">
                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"></path>
                                    </svg>
                                    Block Selected
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Drivers Table -->
                    <div class="modern-card p-6">
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b border-border">
                                        <th class="p-3 font-semibold text-primary">Select</th>
                                        <th class="p-3 font-semibold text-primary">Driver</th>
                                        <th class="p-3 font-semibold text-primary">Contact</th>
                                        <th class="p-3 font-semibold text-primary">Vehicle</th>
                                        <th class="p-3 font-semibold text-primary">Status</th>
                                        <th class="p-3 font-semibold text-primary">Rating</th>
                                        <th class="p-3 font-semibold text-primary">Earnings</th>
                                        <th class="p-3 font-semibold text-primary">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="drivers-table-body">
                                    <tr>
                                        <td colspan="8" class="text-center p-8 text-secondary">Loading drivers...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div id="passengers-pane" class="pane">
                <div class="card p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-4">
                        <input type="text" id="passenger-search-input" placeholder="{{ _('search_by_name_phone') }}" class="border p-2 rounded-md w-64">
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead>
                                <tr class="border-b border-border">
                                    <th class="p-2">ID</th>
                                    <th>Name</th>
                                    <th>Contact</th>
                                    <th>Rides Taken</th>
                                    <th>Member Since</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="passengers-table-body">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div id="rides-pane" class="pane">
                <div class="card p-6 rounded-lg shadow">
                    <div class="flex justify-between items-center mb-4"><input type="text" id="ride-history-search" placeholder="{{ _('search_by_passenger_driver') }}" class="border p-2 rounded w-1/3"><div><button id="ride-history-prev" class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600">&lt; {{ _('prev') }}</button><span id="ride-history-page-info" class="mx-2 text-primary">{{ _('page') }} 1</span><button id="ride-history-next" class="px-3 py-1 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600">{{ _('next') }} &gt;</button></div></div>
                    <table class="w-full text-left"><thead><tr class="border-b border-border"><th class="p-2">ID</th><th>Passenger</th><th>Driver</th><th>Fare</th><th>Status</th><th>Rating</th><th>Date</th><th>Actions</th></tr></thead><tbody id="rides-history-table-body"></tbody></table>
                </div>
            </div>

            <div id="driver-earnings-pane" class="pane">
                <div class="space-y-6">
                    <!-- Header with Actions -->
                    <div class="modern-card p-6">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-2">Driver Earnings Management</h3>
                                <p class="text-secondary">Track driver earnings, commissions, and payment status</p>
                            </div>
                            <div class="flex gap-3">
                                <button id="calculate-earnings-btn" class="btn-modern btn-success">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                    </svg>
                                    Calculate Earnings
                                </button>
                                <button id="commission-settings-btn" class="btn-modern btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                    Commission Settings
                                </button>
                            </div>
                        </div>
                        
                        <!-- Filters -->
                        <div class="flex flex-wrap gap-4 mb-6">
                            <div class="flex-1 min-w-48">
                                <label class="block text-sm font-medium text-primary mb-2">Date Range</label>
                                <div class="flex gap-2">
                                    <input type="date" id="earnings-start-date" class="border border-border rounded-md px-3 py-2 flex-1">
                                    <input type="date" id="earnings-end-date" class="border border-border rounded-md px-3 py-2 flex-1">
                                </div>
                            </div>
                            <div class="min-w-48">
                                <label class="block text-sm font-medium text-primary mb-2">Driver</label>
                                <select id="earnings-driver-filter" class="border border-border rounded-md px-3 py-2 w-full">
                                    <option value="">All Drivers</option>
                                </select>
                            </div>
                            <div class="flex items-end">
                                <button id="earnings-filter-btn" class="btn-modern">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"></path>
                                    </svg>
                                    Filter
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="stat-card-modern">
                            <div class="stat-icon-modern gradient-bg-primary">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-secondary mb-1">Total Earnings</p>
                                <p id="total-driver-earnings" class="text-2xl font-bold text-primary">0 ETB</p>
                            </div>
                        </div>
                        <div class="stat-card-modern">
                            <div class="stat-icon-modern gradient-bg-secondary">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-secondary mb-1">Total Commission</p>
                                <p id="total-commission" class="text-2xl font-bold text-primary">0 ETB</p>
                            </div>
                        </div>
                        <div class="stat-card-modern">
                            <div class="stat-icon-modern gradient-bg-success">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-secondary mb-1">Active Drivers</p>
                                <p id="active-drivers-count" class="text-2xl font-bold text-primary">0</p>
                            </div>
                        </div>
                        <div class="stat-card-modern">
                            <div class="stat-icon-modern gradient-bg-warning">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <div>
                                <p class="text-xs text-secondary mb-1">Pending Payments</p>
                                <p id="pending-payments-count" class="text-2xl font-bold text-primary">0</p>
                            </div>
                        </div>
                    </div>

                    <!-- Driver Earnings Table -->
                    <div class="modern-card p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h4 class="text-xl font-semibold text-primary">Driver Earnings Summary</h4>
                            <div class="flex gap-2">
                                <button id="export-earnings-btn" class="btn-modern btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Export
                                </button>
                            </div>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead>
                                    <tr class="border-b border-border">
                                        <th class="p-3 font-semibold text-primary">Driver</th>
                                        <th class="p-3 font-semibold text-primary">Vehicle</th>
                                        <th class="p-3 font-semibold text-primary">Total Rides</th>
                                        <th class="p-3 font-semibold text-primary">Total Fare</th>
                                        <th class="p-3 font-semibold text-primary">Commission</th>
                                        <th class="p-3 font-semibold text-primary">Driver Earnings</th>
                                        <th class="p-3 font-semibold text-primary">Avg per Ride</th>
                                        <th class="p-3 font-semibold text-primary">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="driver-earnings-table-body">
                                    <tr>
                                        <td colspan="8" class="text-center p-8 text-secondary">Loading earnings data...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Simple Analytics Pane -->
            <div id="analytics-pane" class="pane">
                <div class="card p-4 rounded-lg shadow mb-6">
                    <div id="analytics-filters" class="flex flex-wrap items-center gap-x-6 gap-y-2">
                        <h3 class="text-lg font-semibold text-primary">Filter by Date</h3>
                        <div class="flex items-center gap-2" id="analytics-period-btns">
                            <button data-period="today" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">Today</button>
                            <button data-period="week" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">This Week</button>
                            <button data-period="month" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">This Month</button>
                            <button data-period="all" class="analytics-filter-btn px-3 py-1.5 text-sm font-semibold rounded-md bg-gray-200 dark:bg-gray-700">All Time</button>
                        </div>
                    </div>
                </div>
                
                <!-- KPI Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
                    <div class="kpi-card card rounded-lg shadow">
                        <p class="kpi-title">Rides Completed</p>
                        <p id="kpi-rides-completed" class="kpi-value" style="color: var(--chart-green);">0</p>
                        <div id="kpi-rides-trend" class="kpi-trend">--</div>
                    </div>
                    <div class="kpi-card card rounded-lg shadow">
                        <p class="kpi-title">Active Rides</p>
                        <p id="kpi-active-rides-now" class="kpi-value flex items-center" style="color: var(--chart-blue);">0 <span class="ml-2 w-3 h-3 bg-blue-500 rounded-full animate-pulse"></span></p>
                        <div class="kpi-trend opacity-0">--</div>
                    </div>
                    <div class="kpi-card card rounded-lg shadow">
                        <p class="kpi-title">Rides Canceled</p>
                        <p id="kpi-rides-canceled" class="kpi-value" style="color: var(--chart-red);">0</p>
                        <div class="kpi-trend opacity-0">--</div>
                    </div>
                    <div class="kpi-card card rounded-lg shadow">
                        <p class="kpi-title">Total Revenue</p>
                        <p id="kpi-total-revenue" class="kpi-value" style="color: var(--chart-purple);">0</p>
                        <div id="kpi-revenue-trend" class="kpi-trend">--</div>
                    </div>
                    <div class="kpi-card card rounded-lg shadow">
                        <p class="kpi-title">Average Fare</p>
                        <p id="kpi-avg-fare" class="kpi-value" style="color: var(--chart-orange);">0</p>
                        <div class="kpi-trend opacity-0">--</div>
                    </div>
                </div>
                
                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 card p-6 rounded-lg shadow">
                        <h3 class="font-semibold mb-4 text-primary">Revenue Over Time</h3>
                        <div class="relative h-96">
                            <canvas id="revenue-over-time-chart"></canvas>
                        </div>
                    </div>
                    <div class="space-y-8">
                        <div class="card p-6 rounded-lg shadow">
                            <h3 class="font-semibold mb-4 text-primary">Vehicle Distribution</h3>
                            <div class="relative h-40">
                                <canvas id="vehicle-dist-chart"></canvas>
                            </div>
                        </div>
                        <div class="card p-6 rounded-lg shadow">
                            <h3 class="font-semibold mb-4 text-primary">Payment Methods</h3>
                            <div class="relative h-40">
                                <canvas id="payment-dist-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Top Drivers -->
                <div class="card p-6 rounded-lg shadow mt-8">
                    <h3 class="font-semibold text-primary mb-4">Top 5 Drivers This Week</h3>
                    <div id="top-drivers-list" class="space-y-3">
                        <p class="text-center text-gray-500">Loading driver data...</p>
                    </div>
                </div>
            </div>
            
            <div id="settings-pane" class="pane">
                <div class="card p-6 rounded-lg shadow">
                    <div class="border-b border-[--border-color]">
                        <nav id="settings-tabs" class="-mb-px flex space-x-6" aria-label="Tabs">
                            <button class="settings-tab active" data-target="profile-settings">{{ _('my_profile') }}</button>
                            <button class="settings-tab" data-target="fare-settings">{{ _('fare_app') }}</button>
                            <button class="settings-tab" data-target="user-management-settings">{{ _('user_management') }}</button>
                        </nav>
                    </div>
                    <div class="py-6">
                        <div id="profile-settings-content" class="settings-content active">
                            <h3 class="text-xl font-semibold mb-6 text-primary">{{ _('your_account') }}</h3>
                            
                            <!-- Profile Information Form -->
                            <div class="mb-8 p-4 bg-[--main-bg] rounded-lg">
                                <h4 class="text-lg font-semibold mb-4 text-primary">Profile Information</h4>
                            <form id="update-profile-form" class="space-y-4 max-w-md">
                                <div class="flex items-center space-x-4">
                                    <img id="settings-avatar" src="/{{ current_user.profile_picture or 'static/img/default_avatar.png' }}" class="h-16 w-16 rounded-full object-cover" alt="{{ _('your_avatar') }}">
                                    <div>
                                        <label for="update-profile-picture" class="file-input-label hover:bg-[--border-color]">Change Picture</label>
                                        <input type="file" name="profile_picture" id="update-profile-picture" class="hidden" accept="image/*" onchange="updateFilenameLabel(this.id, 'profile-picture-filename')">
                                        <p id="profile-picture-filename" class="file-input-filename text-xs mt-1">No file chosen</p>
                                    </div>
                                </div>
                                <div><label for="update-username" class="block text-sm font-medium">Username</label><input type="text" name="username" id="update-username" value="{{ current_user.username }}" required class="border p-2 rounded-md w-full mt-1"></div>
                                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-lg">Save Profile</button>
                                <p id="profile-feedback" class="text-sm mt-2"></p>
                            </form>
                            </div>
                            
                            <!-- Change Password Form -->
                            <div class="p-4 bg-[--main-bg] rounded-lg">
                                <h4 class="text-lg font-semibold mb-4 text-primary">Change Password</h4>
                                <button id="change-password-btn" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
                                    Change Password
                                </button>
                                <p class="text-xs text-secondary mt-2">Update your account password</p>
                            </div>
                        </div>
                        <div id="fare-settings-content" class="settings-content">
                            <h3 class="text-xl font-semibold mb-4 text-primary">{{ _('fare_configuration') }}</h3>
                            <form id="settings-form" class="space-y-4 max-w-md">
                                <div><label for="base-fare" class="block">Base Fare (ETB)</label><input type="number" step="any" name="base_fare" class="border p-2 rounded-md w-full mt-1"></div>
                                <div><label for="per-km-bajaj" class="block">Per/KM Rate - Bajaj (ETB)</label><input type="number" step="any" name="per_km_bajaj" class="border p-2 rounded-md w-full mt-1"></div>
                                <div><label for="per-km-car" class="block">Per/KM Rate - Car (ETB)</label><input type="number" step="any" name="per_km_car" class="border p-2 rounded-md w-full mt-1"></div>
                                <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-lg">{{ _('save_fare_settings') }}</button>
                            </form>
                        </div>
                        <div id="user-management-settings" class="settings-content">
                            <h3 class="text-xl font-semibold mb-4 text-primary">{{ _('manage_admin_users') }}</h3>
                            <div id="admin-users-list" class="mt-2 space-y-2 max-w-md"></div>
                            <form id="add-admin-form" class="flex gap-2 mt-4 max-w-md">
                                <input type="text" id="new-admin-username" placeholder="{{ _('new_username') }}" required class="border p-2 rounded-md flex-grow">
                                <input type="password" id="new-admin-password" placeholder="{{ _('password') }}" required class="border p-2 rounded-md flex-grow">
                                <button type="submit" class="px-4 py-2 text-sm bg-green-600 text-white rounded-lg">Add</button>
                            </form>
                            <p id="admin-feedback" class="text-sm mt-2"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Modals -->
<div id="add-driver-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-md">
        <h2 class="text-2xl font-bold mb-6">{{ _('add_new_driver') }}</h2>
        <form id="add-driver-form" enctype="multipart/form-data" class="max-h-[75vh] overflow-y-auto pr-4 space-y-4">
            <div><label class="block text-sm font-medium">Name</label><input type="text" name="name" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Phone</label><input type="text" name="phone_number" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Vehicle Type</label><select name="vehicle_type" required class="mt-1 block w-full p-2 border rounded-md"><option value="Bajaj">Bajaj</option><option value="Car">Car</option><option value="Minibus">Minibus</option></select></div>
            <div><label class="block text-sm font-medium">Vehicle Details (e.g., Blue Bajaj)</label><input type="text" name="vehicle_details" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Plate Number</label><input type="text" name="vehicle_plate_number" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">License Info</label><input type="text" name="license_info" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium mb-1">Profile Picture (Optional)</label><input type="file" name="profile_picture" id="add-profile-picture" class="hidden" accept="image/*" onchange="updateFilenameLabel(this.id, 'add-profile-filename')"><label for="add-profile-picture" class="file-input-label">Choose File</label><span id="add-profile-filename" class="file-input-filename">No file chosen</span></div>
            <div><label class="block text-sm font-medium mb-1">License Document (Optional)</label><input type="file" name="license_document" id="add-license-document" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="updateFilenameLabel(this.id, 'add-license-filename')"><label for="add-license-document" class="file-input-label">Choose File</label><span id="add-license-filename" class="file-input-filename">No file chosen</span></div>
            <div><label class="block text-sm font-medium mb-1">Vehicle Document (Optional)</label><input type="file" name="vehicle_document" id="add-vehicle-document" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="updateFilenameLabel(this.id, 'add-vehicle-filename')"><label for="add-vehicle-document" class="file-input-label">Choose File</label><span id="add-vehicle-filename" class="file-input-filename">No file chosen</span></div>
            <div class="flex justify-end space-x-4 pt-4"><button type="button" class="cancel-modal-btn px-4 py-2 bg-gray-200 rounded-lg">Cancel</button><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-lg">Save</button></div>
        </form>
    </div>
</div>

<div id="edit-driver-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-md">
        <h2 class="text-2xl font-bold mb-6">Edit Driver</h2>
        <form id="edit-driver-form" enctype="multipart/form-data" class="max-h-[75vh] overflow-y-auto pr-4 space-y-4">
            <input type="hidden" name="id">
            <div><label class="block text-sm font-medium">Name</label><input type="text" name="name" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Phone</label><input type="text" name="phone_number" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Vehicle Type</label><select name="vehicle_type" required class="mt-1 block w-full p-2 border rounded-md"><option value="Bajaj">Bajaj</option><option value="Car">Car</option><option value="Minibus">Minibus</option></select></div>
            <div><label class="block text-sm font-medium">Vehicle Details</label><input type="text" name="vehicle_details" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Plate Number</label><input type="text" name="vehicle_plate_number" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">License Info</label><input type="text" name="license_info" required class="mt-1 block w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium mb-1">New Profile Picture (Optional)</label><input type="file" name="profile_picture" id="edit-profile-picture" class="hidden" accept="image/*" onchange="updateFilenameLabel(this.id, 'edit-profile-filename')"><label for="edit-profile-picture" class="file-input-label">Choose File</label><span id="edit-profile-filename" class="file-input-filename">No file chosen</span></div>
            <div><label class="block text-sm font-medium mb-1">New License Document (Optional)</label><input type="file" name="license_document" id="edit-license-document" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="updateFilenameLabel(this.id, 'edit-license-filename')"><label for="edit-license-document" class="file-input-label">Choose File</label><span id="edit-license-filename" class="file-input-filename">No file chosen</span></div>
            <div><label class="block text-sm font-medium mb-1">New Vehicle Document (Optional)</label><input type="file" name="vehicle_document" id="edit-vehicle-document" class="hidden" accept=".pdf,.jpg,.jpeg,.png" onchange="updateFilenameLabel(this.id, 'edit-vehicle-filename')"><label for="edit-vehicle-document" class="file-input-label">Choose File</label><span id="edit-vehicle-filename" class="file-input-filename">No file chosen</span></div>
            <div class="flex justify-end space-x-4 pt-4"><button type="button" class="cancel-modal-btn px-4 py-2 bg-gray-200 rounded-lg">Cancel</button><button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-lg">Save Changes</button></div>
        </form>
    </div>
</div>

<div id="delete-driver-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-sm text-center">
        <h2 class="text-xl font-bold mb-2">Are you sure?</h2><p class="text-secondary mb-6">This will permanently delete the driver. This action cannot be undone.</p>
        <div class="flex justify-center space-x-4"><button type="button" class="cancel-modal-btn px-6 py-2 bg-gray-200 rounded-lg">Cancel</button><button id="confirm-delete-btn" type="button" class="px-6 py-2 bg-red-600 text-white rounded-lg">Delete</button></div>
    </div>
</div>

<div id="driver-details-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden overflow-y-auto">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-3xl my-8">
        <div class="flex justify-between items-start"><h2 class="text-2xl font-bold mb-4">Driver Details</h2><button type="button" class="cancel-modal-btn -mt-2 -mr-2 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">&times;</button></div>
        <div id="driver-details-content" class="max-h-[75vh] overflow-y-auto pr-4"></div>
    </div>
</div>

<div id="passenger-details-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden overflow-y-auto">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-3xl my-8">
        <div class="flex justify-between items-start">
            <h2 class="text-2xl font-bold mb-4">Passenger Details</h2>
            <button type="button" class="cancel-modal-btn -mt-2 -mr-2 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">&times;</button>
        </div>
        <div id="passenger-details-content" class="max-h-[75vh] overflow-y-auto pr-4"></div>
    </div>
</div>

<div id="ride-details-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden overflow-y-auto">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-4xl my-8">
        <div class="flex justify-between items-start">
            <h2 class="text-2xl font-bold mb-4">Trip Details</h2>
            <button type="button" class="cancel-modal-btn -mt-2 -mr-2 p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700">&times;</button>
        </div>
        <div id="ride-details-content" class="max-h-[80vh] overflow-y-auto pr-4"></div>
    </div>
</div>

<div id="change-password-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-md">
        <h2 class="text-2xl font-bold mb-6">Change Password</h2>
        <form id="change-password-form" class="space-y-4">
            <div>
                <label for="password-current-password" class="block text-sm font-medium mb-1">Current Password</label>
                <input type="password" id="password-current-password" required class="mt-1 block w-full p-2 border rounded-md">
            </div>
            <div>
                <label for="password-new-password" class="block text-sm font-medium mb-1">New Password</label>
                <input type="password" id="password-new-password" required class="mt-1 block w-full p-2 border rounded-md">
            </div>
            <div>
                <label for="password-confirm-password" class="block text-sm font-medium mb-1">Confirm New Password</label>
                <input type="password" id="password-confirm-password" required class="mt-1 block w-full p-2 border rounded-md">
            </div>
            <p id="password-feedback" class="text-sm mt-2"></p>
            <div class="flex justify-end space-x-4 pt-4">
                <button type="button" class="cancel-modal-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-lg">Cancel</button>
                <button type="submit" class="px-4 py-2 bg-orange-600 text-white rounded-lg">Change Password</button>
            </div>
        </form>
    </div>
</div>

<div id="confirm-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-sm text-center">
        <h2 class="text-xl font-bold mb-2" id="confirm-modal-title">Confirm Action</h2>
        <p class="text-secondary mb-6" id="confirm-modal-message">Are you sure?</p>
        <div class="flex justify-center space-x-4">
            <button type="button" class="cancel-modal-btn px-6 py-2 bg-gray-200 text-gray-800 rounded-lg">Cancel</button>
            <button id="confirm-modal-btn" type="button" class="px-6 py-2 bg-red-600 text-white rounded-lg">Confirm</button>
        </div>
    </div>
</div>

<div id="block-user-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-md">
        <h2 class="text-2xl font-bold mb-6">Block User</h2>
        <form id="block-user-form" class="space-y-4">
            <input type="hidden" id="block-user-id">
            <input type="hidden" id="block-user-type">
            <div>
                <label for="block-reason" class="block text-sm font-medium mb-1">Reason for blocking</label>
                <textarea id="block-reason" rows="3" required class="mt-1 block w-full p-2 border rounded-md" placeholder="Enter reason..."></textarea>
            </div>
            <p id="block-feedback" class="text-sm mt-2"></p>
            <div class="flex justify-end space-x-4 pt-4">
                <button type="button" class="cancel-modal-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-lg">Cancel</button>
                <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded-lg">Block User</button>
            </div>
        </form>
    </div>
</div>


<!-- Commission Settings Modal -->
<div id="commission-settings-modal" class="modal fixed inset-0 z-50 items-center justify-center hidden">
    <div class="absolute inset-0 bg-black opacity-50"></div>
    <div class="modal-content p-8 rounded-lg shadow-xl z-10 w-full max-w-md">
        <h2 class="text-2xl font-bold mb-6">Commission Settings</h2>
        <form id="commission-settings-form" class="space-y-4">
            <div>
                <label for="bajaj-commission-rate" class="block text-sm font-medium mb-2">Bajaj Commission Rate (%)</label>
                <input type="number" id="bajaj-commission-rate" name="bajaj_rate" min="0" max="100" step="0.1" 
                       class="w-full p-3 border border-border rounded-md" placeholder="15.0" required>
            </div>
            <div>
                <label for="car-commission-rate" class="block text-sm font-medium mb-2">Car Commission Rate (%)</label>
                <input type="number" id="car-commission-rate" name="car_rate" min="0" max="100" step="0.1" 
                       class="w-full p-3 border border-border rounded-md" placeholder="20.0" required>
            </div>
            <div class="flex justify-end space-x-3 pt-4">
                <button type="button" class="cancel-modal-btn px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">
                    Cancel
                </button>
                <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                    Save Settings
                </button>
            </div>
        </form>
        <p id="commission-feedback" class="text-sm mt-3"></p>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/moment@2.29.1/moment.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script>
    // Pass template variables to JavaScript
    window.TEMPLATE_VARS = {
        LANG: "{{ session.get('language', 'en') }}",
        API_BASE_URL: 'http://127.0.0.1:5000/api'
    };
</script>
{% endblock %}
